<?xml version="1.0" encoding="UTF-8"?>
<job id="extractionJob" xmlns="http://xmlns.jcp.org/xml/ns/javaee"
	version="1.0">
	<properties>
		<property name="baseUrl" value="http://www.reifendirekt.at/cgi-bin/rshop.pl"></property>
		<property name="retry-limit" value="10" />
	</properties>
	<step id="detailLinkExtraction" next="detailExtraction">
		<chunk retry-limit="10" item-count="10">
			<reader ref="DetailLinkReader">
				<properties>
					<property name="fromIndex" value="#{partitionPlan['fromIndex']}" />
					<property name="toIndex" value="#{partitionPlan['toIndex']}" />
					<property name="baseUrl" value="#{jobProperties['baseUrl']}" />
					<property name="retry-limit" value="#{jobProperties['retry-limit']}" />
				</properties>
			</reader>
			<processor ref="DetailLinkProcessor"></processor>
			<writer ref="DetailLinkWriter"></writer>

			<retryable-exception-classes>
				<include
					class="com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException" />
			</retryable-exception-classes>
			<skippable-exception-classes>
				<include
					class="com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException" />
			</skippable-exception-classes>
		</chunk>
		<partition>
			<mapper ref="DetailLinkPartitionMapper">
				<properties>
					<property name="baseUrl" value="#{jobProperties['baseUrl']}" />
				</properties>
			</mapper>
			<reducer ref="DetailLinkReducer"></reducer>
		</partition>
		<listeners>
			<listener ref="ReadListenerImpl" />
		</listeners>
	</step>
	<step id="detailExtraction">
		<chunk retry-limit="10" item-count="10">
			<reader ref="DetailReader">
				<properties>
					<property name="fromIndex" value="#{partitionPlan['fromIndex']}" />
					<property name="toIndex" value="#{partitionPlan['toIndex']}" />
					<property name="baseUrl" value="#{jobProperties['baseUrl']}" />
					<property name="retry-limit" value="#{jobProperties['retry-limit']}" />
				</properties>
			</reader>
			<processor ref="DetailProcessor" />
			<writer ref="DetailWriter" />
			<retryable-exception-classes>
				<include
					class="com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException" />
				<include class="java.net.SocketTimeoutException" />
			</retryable-exception-classes>
			<skippable-exception-classes>
				<include
					class="com.becker.webdataextraction.DetailPageElementNotFoundException" />
				<include
					class="com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException" />
			</skippable-exception-classes>
		</chunk>
		<partition>
			<mapper ref="DetailPartitionMapper">
				<properties>
					<property name="baseUrl" value="#{jobProperties['baseUrl']}" />
				</properties>
			</mapper>
		</partition>
		<listeners>
			<listener ref="ReadListenerImpl" />
			<listener ref="DetailStepListener" />
		</listeners>
		<end on="COMPLETED" />
	</step>
</job>