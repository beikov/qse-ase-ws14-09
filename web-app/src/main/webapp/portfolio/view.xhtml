<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ase="http://java.sun.com/jsf/composite/portfoliosimcomponents"
	template="/WEB-INF/templates/template.xhtml">

	<!-- content -->
	<ui:define name="body">
	
		<f:metadata>
			<f:viewParam name="portfolioId" value="#{portfolioViewBean.portfolioId}" required="true" />
		    <f:viewAction action="#{portfolioViewBean.init}" />
		</f:metadata>
		
		<h:form id="portfolioViewForm">
		<p:growl id="msg" />
		
		
			<div class="row" style="margin-bottom: 15px;">
				<div class="col-md-8">
					<p:panel id="stats" header="Übersicht">
						<p:panelGrid columns="2">
							<h:outputText value="Portfolio:" />
							<h:outputText value="#{portfolioViewBean.portfolio.name}" />
							
							<h:outputText value="Besitzer:" />
							<h:outputText value="#{portfolioViewBean.portfolio.owner.username}" />
							
							<h:outputText value="Erstellt:" />
							<h:outputText value="#{dateUtil.formatDate( portfolioViewBean.portfolio.created.time )}" />
							
							<h:outputText value="Aktuelles Kapital:" />
							<h:outputText value="#{portfolioViewBean.portfolio.currentCapital}" />
							
							<h:outputText value="Startkapital:" />
							<h:outputText value="#{portfolioViewBean.portfolio.setting.startCapital}" />
							
							<h:outputText value="Ordergebühr:" />
							<h:outputText value="#{portfolioViewBean.portfolio.setting.orderFee}" />
							
							<h:outputText value="Portfoliogebühr:" />
							<h:outputText value="#{portfolioViewBean.portfolio.setting.portfolioFee}" />
							
							<h:outputText value="Kapitalertragssteuer:" />
							<h:outputText value="#{portfolioViewBean.portfolio.setting.capitalReturnTax} %" />
						</p:panelGrid>
					</p:panel>
				</div>
  				<div class="col-md-4">
  					<p:panel id="follower" header="Follower">
						<c:choose>
							<c:when test="#{ portfolioViewBean.followerList.size() lt 9 }">
								<p:dataList value="#{portfolioViewBean.getFollowerList()}" var="follower" type="unordered" itemType="none" emptyMessage="Keine Follower">
					        		<h:outputText value="#{follower.username}" />
					    		</p:dataList>
							</c:when>
							<c:otherwise>
								<p:dataList value="#{portfolioViewBean.getFollowerList()}" var="follower" type="unordered" itemType="none" paginator="true" rows="8" styleClass="paginated">
					        		<h:outputText value="#{follower.username}" />
					    		</p:dataList>
							</c:otherwise>
						</c:choose>
					</p:panel>
  				</div>
			</div>
			<div class="row" style="margin-bottom: 15px;">
				<div class="col-md-12">
					<p:tabView>
						<p:tab>
							<f:facet name="title">
				               	<h:outputText value="Einzeltitel"/>
				               	<!-- <p:selectBooleanCheckbox value="#{portfolioViewBean.portfolio.visibility.valuePaperListVisible}">
				            		<p:ajax update=":portfolioViewForm:msg" listener="#{portfolioViewBean.changeVisibility()}" />
				        		</p:selectBooleanCheckbox> -->
				            </f:facet>
				            <ui:include src="_valuePaperTable.xhtml" />
				        </p:tab>
				        <p:tab title="Charts">
				            <c:if test="#{not empty portfolioViewBean.portfolio.valuePapers}">
				        		<div class="row">
				        			<div class="col-md-6">
				        				<p:chart type="pie" model="#{portfolioViewBean.valuePaperTypePie}" />
				        			</div>
				        			<div class="col-md-6">
				        				<p:chart type="pie" model="#{portfolioViewBean.valuePaperCountryPie}" />
				        			</div>
				        		</div>
							</c:if>
				        </p:tab>
				        <p:tab title="Orders">
				        	<ui:include src="_orderTable.xhtml" />
				        </p:tab>
				        <p:tab title="Transaktionen">
				            <ui:include src="_transactionTable.xhtml" />
				        </p:tab>
			    	</p:tabView>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<p:chart type="line" model="#{portfolioViewBean.portfolioChart}" style="height:400px;"/>
				</div>
			</div>
		</h:form>
    			
		
	</ui:define><!-- content -->

</ui:composition>
